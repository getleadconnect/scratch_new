!function(t){t.fn.suggestionBox=function(n){function e(t){_=m.find("li:eq("+t+") a").attr("href"),m.find("li:eq("+t+")").addClass("selected")}function i(t){m.find("li:eq("+t+")").removeClass("selected")}function r(){_="#",w=-1,m.find("li").removeClass("selected")}function s(){w===m.find("li").size()-1?(i(w),r()):(i(w),e(++w))}function u(){w>0?(i(w),e(--w)):-1==w?(i(w),e(w=m.find("li").size()-1)):(i(0),r())}function o(n){y=p.val(),t.ajax({url:n,data:j,dataType:"json",success:function(t){var n=!0,i=w;N.results&&t.results&&(n=JSON.stringify(N.results[w])!==JSON.stringify(t.results[w])),g(t),h(),i>-1&&p.val()===y&&!n&&e(w=i),v.ajaxSuccess(t)},error:function(t){v.ajaxError(t)}})}function a(){var t=f(p,"border-bottom-width")+f(p,"border-top-width"),n=f(p,"padding-bottom")+f(p,"padding-top");m.css({position:"absolute",left:p.offset().left+v.leftOffset,top:p.offset().top+(p.height()+t+n+v.topOffset)})}function f(t,n){return parseInt(t.css(n).replace("px",""))}function c(){v.fadeOut?m.fadeOut():m.css("display","none"),r()}function l(){v.fadeIn?m.fadeIn():m.css("display","block")}function d(){var t=p.width()+f(p,"border-left-width")+f(p,"border-right-width")+f(p,"padding-left")+f(p,"padding-right")+v.widthAdjustment;"auto"==v.menuWidth?m.css({"min-width":t}):"constrain"==v.menuWidth&&m.css({width:t})}function h(){r(),b=!1;var n=v.filter?function n(e){if(e=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),filterPattern=v.filterPattern.replace("{INPUT}",e),!e)return{};if(N&&N.results){var i,r=RegExp(filterPattern,"i");i=t.grep(N.results,function(t){return r.test(t.suggestion)})}v.sort&&i.sort(v.sort);var s=JSON.stringify({results:i});return t.parseJSON(s)}(p.val()):N;if(n&&n.results)var e,i,s=(e=n,i='<div id="suggestion-header">'+v.heading+'</div> <ul id="suggestion-box-list">',t.each(e.results,function(n,e){if(!e.suggestion||!e.url)return!1;b=!0;var r="";return e.attr&&t.each(e.attr,function(t,n){for(var e=Object.keys(n),i=0;i<e.length;i++)r+=e[i]+'="'+n[e[i]]+'" '}),i+='<li class="suggest-li">'+e.url+" "+e.suggestion+"</a></li>",n!==v.results-1&&void 0}),i+="</ul>");S?b?(m.html(s),d(),l()):v.showNoSuggestionsMessage&&p.val().length>0?(d(),l(),m.html('<div id="no-suggestions">'+v.noSuggestionsMessage+"</div>")):c():c()}function g(n){N=n?n instanceof Object?n:t.parseJSON(n):{}}var p=this,v=t.extend({topOffset:0,leftOffset:0,widthAdjustment:0,delay:400,heading:"Powered by getlead",results:10,fadeIn:!0,fadeOut:!1,menuWidth:"auto",showNoSuggestionsMessage:!1,noSuggestionsMessage:"No Suggestions Found",filter:!1,filterPattern:"({INPUT})",ajaxError:function(t){console.log(t)},ajaxSuccess:function(t){},enterKeyAction:function(){m.css("display","none"),window.location=_},paramName:"search"},n);t("body").append('<div id="suggestion-box"></div>'),p.attr("autocomplete","off");var m=t("#suggestion-box");a();var y,w=-1,_="#",$=!1,x=null,b=!1,S=!1,j={},N={};return m.on({mousemove:function(n){var r,s;"A"===n.target.nodeName&&(i(w),e(w=(s=t((r=n).target).parent("li")).parent().children().index(s)),$=!0)},mouseout:function(t){"A"===t.target.nodeName&&($=!1,i(w),r())},click:function(t){"A"===t.target.nodeName&&m.css("display","none")}}),p.on({blur:function(){S=!1,$||c()},focus:function(){S=!0,t(this).val()&&h(N)},keyup:function(t){38!==t.which&&40!==t.which&&27!==t.which&&13!==t.which&&(v.url&&(r(),x&&clearTimeout(x)),v.url&&(j[v.paramName]=p.val(),x=setTimeout(function(){o(v.url)},v.delay)),v.filter&&h())},keydown:function(t){"none"!==m.css("display")&&(40==t.which&&(t.preventDefault(),s()),38==t.which&&(t.preventDefault(),u()),13===t.which&&w>-1&&(t.preventDefault(),v.enterKeyAction()),27==t.which&&(t.preventDefault(),c()))},paste:function(){setTimeout(function(){p.keyup()},200)}}),t(window).resize(function(){a()}),{getSuggestions:function(t){return o(t),this},addSuggestions:function(t){return g(t),this},loadSuggestions:function(n){var e;return e=n,t.ajax({url:e,dataType:"json",success:function(t){g(t)},error:function(t){console.log(t)}}),this},getJson:function(){return JSON.stringify(N)},moveUp:function(){return u(),this},moveDown:function(){return s(),this},selectedUrl:function(){return _},selectedSuggestion:function(){return m.find("li:eq("+w+")").text()},position:function(){return w},select:function(t){return i(w),w=t,e(t),this},reset:function(){return i(w),r(),this},show:function(){return p.focus(),h(),this},hide:function(){return c(),this},url:function(t){return v.url=t,this},fadeIn:function(t){return v.fadeIn=t,this},fadeOut:function(t){return v.fadeOut=t,this},delay:function(t){return v.delay=t,this},heading:function(t){return v.heading=t,this},results:function(t){return v.results=t,this},ajaxError:function(t){return v.ajaxError=t,this},ajaxSuccess:function(t){return v.ajaxSuccess=t,this},filter:function(t){return v.filter=t,this},filterPattern:function(t){return v.filterPattern=t,this},sort:function(t){return v.sort=t,this},enterKeyAction:function(t){return v.enterKeyAction=t,this},destroy:function(){return p.unbind(this),m.remove(),null}}}}(jQuery);